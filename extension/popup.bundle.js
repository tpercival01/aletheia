(()=>{const e=document.getElementById("status_message"),s=document.getElementById("scan_again"),t=document.getElementById("reset_button");function n(s){console.log(s),e.innerHTML=`Status: ${s.status}`,console.log(e.innerHTML)}function o(){chrome.runtime.sendMessage({type:"GET_POPUP_STATE",source:"popup"},e=>{if(chrome.runtime.lastError)return console.error("Could not get initial state from background",chrome.runtime.lastError),void n({status:"Error connecting to background"});if(console.log(e),e)switch(e.status){case"Completed":case"Idle":n(e),s.className="",t.className="";break;case"Processing":n(e)}})}document.getElementById("results_breakdown"),document.getElementById("results_list"),s.addEventListener("click",async()=>{s.className="hidden",t.className="hidden";try{const e=await chrome.runtime.sendMessage({type:"SCAN_AGAIN",source:"popup"});console.log("SCANNED AGAIN"),n(e)}catch(e){console.error("Error sending SCAN_AGAIN message: ",e),n({status:"Error"})}o()}),t.addEventListener("click",async()=>{s.className="hidden",t.className="hidden";try{n(await chrome.runtime.sendMessage({type:"RESET_PAGE_POPUP",source:"popup"}))}catch(e){console.error("Error sending RESET_PAGE message: ",e),n({status:"Error"})}o()}),window.addEventListener("DOMContentLoaded",()=>{o()}),chrome.runtime.onMessage.addListener((e,s,t)=>{e&&("Completed"!=e.status&&"Idle"!=e.status||o())})})();